# ====================================================
# 基础设置
# ====================================================

set -g history-limit 100000           # 历史记录
setw -g mode-keys vi                  # 复制模式使用 vi
setw -g automatic-rename on           # 自动重命名窗口
set-option -g set-titles on           # 自动设置终端标题
setw -g monitor-activity on           # 窗口活动监控
set -g default-terminal "screen-256color"  # 使用 256 色支持


# ====================================================
# 前缀键设置
# ====================================================

set-option -g prefix C-a
unbind-key C-b
bind-key C-a send-prefix


# ====================================================
# 面板管理快捷键
# ====================================================

bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# 方向键分屏（必须先按 Ctrl+a）
bind -T prefix Up split-window -v -b
bind -T prefix Down split-window -v
bind -T prefix Left split-window -h -b
bind -T prefix Right split-window -h

# 面板大小调整（Ctrl+a + Alt+方向键）
bind -T prefix M-Up resize-pane -U 3
bind -T prefix M-Down resize-pane -D 3
bind -T prefix M-Left resize-pane -L 5
bind -T prefix M-Right resize-pane -R 5


# ====================================================
# 窗口管理
# ====================================================

bind c new-window                               # 新建窗口
bind q kill-pane                                # 关闭当前面板
bind n next-window                              # 下一个窗口
bind p previous-window                          # 上一个窗口
bind w list-windows                             # 窗口列表
bind , command-prompt "rename-window %% "       # 重命名窗口
bind . command-prompt "move-window -t %% "      # 移动窗口


# ====================================================
# 会话管理
# ====================================================

bind s choose-session
bind d detach                                   # 分离会话
bind X confirm-before -p "Kill session #S? (y/n)" kill-session


# ====================================================
# 配置管理
# ====================================================

bind r source-file ~/.tmux.conf \; display-message "配置已重新加载!"


# ====================================================
# 鼠标支持
# ====================================================

set -g mouse on


# ====================================================
# 状态栏美化（扩展版）
# ====================================================

set -g status-interval 5
set -g status-style fg=white,bg=black

setw -g window-status-current-style fg=black,bg=green
setw -g window-status-current-format " #I:#W "
setw -g window-status-format " #I:#W "

# 状态栏左侧显示会话名
set -g status-left " [#S] "

# 状态栏右侧显示：电池 电量 + 时间日期
set -g status-right-length 100
set -g status-right "#(pmset -g batt | grep -Eo '[0-9]+%') | CPU:#(ps -A -o %cpu | awk '{s+=$1} END {print s}' )% | %Y-%m-%d %H:%M "


# ====================================================
# 复制粘贴优化（macOS）
# ====================================================

bind [ copy-mode
bind -T copy-mode-vi y send -X copy-pipe-and-cancel "pbcopy"

